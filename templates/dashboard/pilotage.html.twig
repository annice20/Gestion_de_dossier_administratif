{% extends 'navAdministration.html.twig' %}

{% block title %}Pilotage Diagramme{% endblock %}

{% block body %}
<main class="dashboard" style="display:flex; flex-direction:column; align-items:center; gap:40px; padding:20px; background-color:#f9f9f9;">

    <h1 class="dashboard-title">Pilotage - Diagramme</h1>

    <div style="width:300px; background-color:white; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.1);">
        <h3 style="text-align:center;">Documents</h3>
        <canvas id="documentsChart" width="300" height="300"></canvas>
    </div>

    <div style="width:300px; background-color:white; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.1);">
        <h3 style="text-align:center;">Demandes</h3>
        <canvas id="demandesChart" width="300" height="300"></canvas>
    </div>

</main>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const labels = {{ labels|json_encode|raw }};
    const dataDocuments = {{ dataDocuments|json_encode|raw }};
    const dataDemandes = {{ dataDemandes|json_encode|raw }};

    // Documents Pie Chart
    new Chart(document.getElementById('documentsChart').getContext('2d'), {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: dataDocuments,
                backgroundColor: ['#36A2EB', '#FF6384', '#FFCE56']
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'top' },
                title: { display: true, text: 'Répartition des documents par statut', font: { size: 14 } }
            }
        }
    });

    // Demandes Pie Chart
    new Chart(document.getElementById('demandesChart').getContext('2d'), {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: dataDemandes,
                backgroundColor: ['#4BC0C0', '#9966FF', '#FF9F40']
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'top' },
                title: { display: true, text: 'Répartition des demandes par statut', font: { size: 14 } }
            }
        }
    });
</script>
{% endblock %}
